---
title: "exploring_data"
output: html_document
date: "2023-10-12"
---

Notes:
- WGT2017_2019 is the weights
- This is a pdf explaining: https://www.cdc.gov/nchs/data/nsfg/NSFG-2017-2019-UG-MainText-508.pdf
- Could combine 2011-2019


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r}

men <- read_csv("data/csv_2017_2019_Male.csv")

```
#sexual orientation
```{r}
 men |> filter(ncall != "none") |> group_by(ORIENT_A) |> summarize(count = n())
```

#demographic mapping
```{r}
men |> group_by(nformwife) |> filter(nformwife != "NA" & nformwife != "none") |> summarize(form_wives = n()) |>
  ggplot(aes(x=nformwife, y=form_wives)) + geom_col()

```

#is there any overlap between coresidential and non-coresidental fathers? - yes - 183 of them.
#what can we learn about non-coresidential fathers? - avg age 36.75 - similar 

```{r}
#men |> filter(ncall != "none" & crall != "none") |> select(rscrage, ncall, crall)

men |> filter(ncall != "none") |> group_by(ncall) |> summarize(n_kids = n())
men |> filter(ncall != "none") |> mutate(num_age = as.numeric(gsub("[^0-9]", "", AGE_A))) |> summarize(avg_age = mean(num_age, na.rm = TRUE))
men |> filter(ncall != "none") |> group_by(marstat) |> summarize(cur_mar = n()) |> ggplot(aes(y=marstat, x=cur_mar)) + geom_col()


```

#Extra random stuff

```{r}
##NRAFFECT04 - "In the last four weeks, how often did you... ) Praise [NAME OF NONCORESIDENTIAL FOCAL CHILD] for doing something worthwhile?" For ages 0-4

affect04 <- div_nev_men |> filter(NRAFFECT04 != "NA" & NRAFFECT04 != "Not ascertained") |> mutate(affect_bool_04 = case_when(NRAFFECT04 == "Not at all" ~ 0, NRAFFECT04 == "Less than once a week" ~ 0.5, NRAFFECT04 == "About once a week" ~ 1, NRAFFECT04 == "Several times a week" ~ 3, NRAFFECT04 == "Every day (at least once a day)" ~ 7))

regression_affect04 <- lm(affect_bool_04 ~ divorced_vs_never + age_num + race + totincr, data = affect04)

modelsummary::modelsummary(regression_affect04, statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"), gof_map = c("nobs", "r.squared", "adj.r.squared"))

##NRAFFECT518 - same thing, children 5-18
affect518 <- div_nev_men |> filter(NRAFFECT518 != "NA" & NRAFFECT518 != "Not ascertained" & NRAFFECT518 != "Don't know") |> mutate(affect_bool_518 = case_when(NRAFFECT518 == "Not at all" ~ 0, NRAFFECT518 == "Less than once a week" ~ 0.5, NRAFFECT518 == "About once a week" ~ 1, NRAFFECT518 == "Several times a week" ~ 3, NRAFFECT518 == "Every day (at least once a day)" ~ 7))

regression_affect518 <- lm(affect_bool_518 ~ divorced_vs_never + age_num + race + totincr, data = affect518)

modelsummary::modelsummary(regression_affect518, statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"), gof_map = c("nobs", "r.squared", "adj.r.squared"))


```

```{r}
#focal child is the youngest child of the survey respondent
men |> filter(ncall != "none") |> select(caseid, ncall, NRMEAL04, NRMEAL518)

#glimpse(men$NUMNCU18)

```


#LOOKING AT 0-4 vs 5-18
```{r}



recode_num <- function(dataframe_input, variable_input, new_variable_name) {
  new_dataframe <- dataframe_input |> filter(variable_input != "NA") |> mutate(new_variable_name = case_when(variable_input == "Not at all" ~ 1, variable_input == "Less than once a week" ~ 2, variable_input == "About once a week" ~ 3, variable_input == "Several times a week" ~ 4, variable_input == "Every day (at least once a day)" ~ 5))
  return(new_dataframe)
}

#WANT TO THINK ABOUT IMPLICATION OF MISSING DATA - how to look at refused answers? Or if there is a way to infer the rest of the NA answers? What about not ascertained?


#JUST STRAIGHT
#visit_04 <- men |> filter(NRVISIT04 != "NA" & NRVISIT04 != "Not ascertained") |> mutate(visit_bool_04 = case_when(NRVISIT04 == "Not at all" ~ 1, NRVISIT04 == "Less than once a week" ~ 2, NRVISIT04 == "About once a week" ~ 3, NRVISIT04 == "Several times a week" ~ 4, NRVISIT04 == "Every day (at least once a day)" ~ 5))

#DAYS OF WEEK
visit_04 <- men |> filter(NRVISIT04 != "NA" & NRVISIT04 != "Not ascertained") |> mutate(visit_bool_04 = case_when(NRVISIT04 == "Not at all" ~ 0, NRVISIT04 == "Less than once a week" ~ 0.5, NRVISIT04 == "About once a week" ~ 1, NRVISIT04 == "Several times a week" ~ 3, NRVISIT04 == "Every day (at least once a day)" ~ 7))
  
  #recode_num(men, men$NRVISIT04, "visit_bool")
#visit_04$NRVISIT04




```

```{r}

#there's also some "Don't know" here


#JUST STRAIGHT 1 through 5
#visit_518 <- men |> filter(NRVISIT518 != "NA" & NRVISIT518 != "Not ascertained" & NRVISIT518 != "Don't know") |> mutate(visit_bool_518 = case_when(NRVISIT518 == "Not at all" ~ 1, NRVISIT518 == "Less than once a week" ~ 2, NRVISIT518 == "About once a week" ~ 3, NRVISIT518 == "Several times a week" ~ 4, NRVISIT518 == "Every day (at least once a day)" ~ 5))


##TRYING WITH DAYS OF WEEK INSTEAD
visit_518 <- men |> filter(NRVISIT518 != "NA" & NRVISIT518 != "Not ascertained" & NRVISIT518 != "Don't know") |> mutate(visit_bool_518 = case_when(NRVISIT518 == "Not at all" ~ 0, NRVISIT518 == "Less than once a week" ~ 0.5, NRVISIT518 == "About once a week" ~ 1, NRVISIT518 == "Several times a week" ~ 3, NRVISIT518 == "Every day (at least once a day)" ~ 7))



ate_marriage_status_04 <- visit_04 |> group_by(marstat) |> summarize(avg_visits_04 = mean(visit_bool_04)) |> filter(marstat == "Divorced or annulled" | marstat == "Never been married")

ate_marriage_status_518 <- visit_518 |> group_by(marstat) |> summarize(avg_visits_518 = mean(visit_bool_518)) |> filter(marstat == "Divorced or annulled" | marstat == "Never been married")

ate_mar_total <- left_join(ate_marriage_status_04, ate_marriage_status_518)



#ate_marriage_status_04
#ate_marriage_status_518

#ate

#engagement does drop off
#this effect can be seen clearer when making rough approximations for the number of days that somebody would be seeing their kids. 
#the parent of a 5-18 year old sees their kid on average 1 day less per week than the non-coresidential parent of a 0-4 year old. 

```


#general
#NRVISIT04
#NRSATVIS04

#accessibility - spending time with child
#NROUTG04
#NRMEAL04
#NRERRAND04
#NROVRNT04
#NRPLAY04
#NRREAD04
#NRAFFECT04
#NRPRAISE04

#responsibility - management of child's life
#NRFEED04
#NRBATH04
#NRDIAPER04
#NRBED04
#NRAPPT04

#Discipline/monitoring
#NRDISC04




```{r}
#ncall is number of non-coresidential children
#need to see if men are currently married as well, and to which of their wives the kids belong


men |> mutate(form_wife_bool = ifelse(nformwife == "none", 0, 1), meal_scale = case_when(NRMEAL04 == "Not at all" ~ 1, NRMEAL04 == "Less than once a week" ~ 2, NRMEAL04 == "About once a week" ~ 3, NRMEAL04 == "Several times a week " ~ 4,NRMEAL04 == "Every day (at least once a day)" ~ 5)) |> group_by(form_wife_bool) |> summarize(mean_meal = mean(meal_scale, na.rm = TRUE))



```


```{r}

sex_graph <- men |> mutate(sex_yes = ifelse(hadsex == "YES, R EVER HAD INTERCOURSE", 1, 0))|>group_by(AGE_R) |>  summarize(sex_prop = mean(sex_yes, na.rm = TRUE))

ggplot(sex_graph, aes(x=AGE_R, y= sex_prop)) + geom_col()

```

